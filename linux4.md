# linux4

[TOC]

## linux中的文件搜索命令

### locate命令
1.locate命令非常的简单，就是locate加上文件名，此时就可以进行搜索，但是搜索的时候注意，你会经常发现搜索命令的时候返回空，也就是未搜索到，这是因为locate只会去搜索linux下的/var/lib/mlocate目录，这个目录不是实时更新，而是一天更新一次，也就是说我们可能找不到之前创建的文件，这个时候就需要updatedb帮助我们更新此目录，随后便可以查找了。
2.locate最大特点就是搜索的速度非常快，原因就是他只查找一部分目录，但是他只能按照文件名查找文件，这是存在局限性的，但是幸运我们一般只需要这种功能，也就是说通常locate可以满足我们需求，我们唯一必须要做的就是updatedb。
3.如果我们在tmp目录下创建文件，然后updatedb，这个时候locate这个文件，我们会发现，返回依然为空，我们可以打开/etc/updatedb.conf文件查看，其上面的四句话分别表示“是否遵循下面三条规则”、“那些类型的配置文件我们我搜索”、“哪些后缀名的文件我不搜索”、“哪些目录下的文件我不搜索”。这是我们可以看到我们的/tmp目录就在这里，所以哪怕我们updatedb，locate也没有办法找到改文件。

### whereis与which
1.whereis是查找命令的命令，其实就是专门用来找命令目录和帮助文档的命令，直接whereis ls就可，他会返回ls的执行文件位置和帮助文档的位置，当然我们可以加选项，-b代表值查看可执行文件；-m只查看文档。
2.在linux中有一些很个性化的指令whatis ls和whoami之类，可以返回ls是什么和当前用户是谁。
3.which和whereis基本一样，只是他在返回可执行文件路径同时会返回命令的别名。
4.cd是个很特殊的东西，他无法通过whereis和which找到，因为他是linux shell的内置命令，没有所谓可执行文件。也就是which和whereis只能找外部安装的命令。
5.当我们搜索指令的时候会发现一个很长的绝对路径，按道理每个可执行文件都一定使用绝对路径来执行，但是linux不需要，原因是我们的系统设置了环境变量，使用echo $PATH可得到这些环境变量：/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/root/bin这些环境变量和Windows下一样都是系统为了简化检索而使用的，其中每当我们执行一条指令，linux都会遍历一次环境变量下的内容以寻找到指令的可执行文件。如果我们想让我们自定义的命令拥有直接引用就可的待遇，就必须为我们的命令添加环境变量。

### find
1.find是linux当中强大的搜索命令，这个命令有很多的扩展功能，参数也很多，一般情况下，find命令为find 搜索范围 搜索条件 这种格式，如find / -name sec就是在根的目录下通过文件名查找sec文件。find命令有一个很重的特性，当我们不适用别的通配符时，find只会找到和我们目标文件名完完全全相等的文件，也就是默认不支持模糊查找，如要查找，必须使用通配符。
2.通配符有三种*、?、[]这三种分别表示匹配任意东西，也就是find /root -name "*"会得到/root下的所有文件；而?则代表单一字符，而[]表示匹配[]中的任意一个字符，如find /root -name "*[cs]"则是得到所有末尾为c或s的文件名。注意这里使用通配符就必须加""。
3.find有别的一些搜索方法，如find /root -iname ...代表搜索...但是不区分...大小写；find /root -user root代表得到root的所有文件，当然这个命令一般不会用，但是find /root -nouser这使用的很多，一般找到了nouser文件代表垃圾文件，但linux有几种特殊情况：1.当该文件外来文件，如光盘，则这个时候linux可能不会指定所有者；2.linux的内核文件不经过系统也没有所有者。这几种情况千万不能删除。
4.find /var -mtime +10表示查找大于10天前做过修改的文件，这个操作是为了得到长期没有改动的垃圾文件，当然可以将+10设10就是10天前的，或者-10是10天以内；-mtime改为ctime表示改变文件属性，atime是文件访问时间。
5.find /etc -size +10k表示在/etc下找到大小大于10k的文件，同样的+10k可改为10l、-10k，但是k必须是小写，而k可以改成M，但是M必须大写。
6.find /root -inum 294表示按照i节点号找文件，这里如果文件是.则代表当前目录下查找。
7.find的多重条件查找find /etc -size +20 -a -size -50表在/etc下找到代销大于10小于50的文件，这里-a表示与，linux也有-o，但是这个操作有个不好，就是他返回后只是文件名，我们还是得输入ls -lh绝对路径才得到文件具体大小，这时我们有一个命令：find /etc -size +10 -a -size -50 exec ls -lh {} \;    这个很复杂的语句就可以获得文件的具体大小，他执行的过程是此：exec表示获取前面命令执行的结果然后执行下面命令，这里是ls -lh，注意后面的{} \;是固定的搭配啊。find . -name c -exec rm -rf {} \; 表示得到c文件且删除他。

### grep
grep "size" anaconda-ks.cfg代表返回文件中的存在size的行。和find用通配符不同，grep使用正则表达式，当我们检索文件名用find，检索文件中具体内容用grep。


