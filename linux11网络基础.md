# linux11网络基础

## osi七层模型
1.osi模型主要用于网络交互，其中从底向上氛围七层：物理层（数据单位比特，持有数据）、数据链路层（数据单位帧，持有数据和网卡的物理地址MAC）、网络层（数据单位报文，持有数据和ip地址）、传输层（数据单位段，TPDU），向上还有三个用户交互的会话层（单位SPDU）、表示层（单位PPDU）、应用层（ADPU）。一般传输数据是从源机从顶向下至物理层，再从物理层传输到外机的物理层，再在外机物理层向上传输，也就是传输从上到下，接收从下到上。注意这里实际上网络交互真正发生不同主机的传输只剩物理层。
1.物理层：负责比特流的传递，还有物理接口、电气特性（网线、网卡都是物理层）。
2.数据链路层：组织数据流成帧，用MAC地址访问媒介，还有错误修正功能。
3.网络层：写入ip地址，发件人和收件都要（也就是提供逻辑地址），还可以选路，也就是选择恰当路径传输数据。
4.传输层：确定我的传输协议是否可靠（TCP（不丢数据）、UDP（熟读更快）），有错误检测和流量控制功能。并且拥有端口号确定我们的服务，注意ip地址是门牌号，我们还要特定的端口号才能得到相应的服务，一般网络服务是80、邮箱服务是25（发）、110（接收）。
5.会话层：确定网络数据是否要经过远程回话。
6.表示层：把数据形式进行转化UTF-8到机器语言或者机器语言-UTF-8，而且表示层可以压缩文件或者加密文件。
7.应用层：用户的接口。
实例发送邮件：我们编写好邮件（应用层），点击发送（表示层，解析文件为机器码），进入会话层查看是传输还是本地保存，传输怎传递给传输层，否则只保存在本地硬盘，传输层确定传输协议，如邮件发送是TCP协议，则将其写入，并且写入邮件的发送的端口25和接收的端口110，再传给网络层，网络层写入发件人的ip和收件人的ip，再传给数据链路层，负责进行局域网传递，从一个局域网进入另一个，最终到达收件人的ip，最后物理层传输文件给接收方的物理层。

## TCP/IP四层模型
1.应用层：由osi应用层、表示层、会话层组成。
2.传输层：就是传输层。确定端口信息和传输协议。TCP和UDP协议起作用，其中TCP起作用是和IP协议交流，在传输的A和接收的B会不断地交互（三次握手，A:在吗？    B:在，你还在吗？    A:在，我要发数据了）确保数据传输没问题。但是UDP直接发数据不会和B交互。
3.网络层：就是网络层，确定传输者接受者ip。主要有网际协议IP，用来确定接收传输的ip地址并决定传输方式。
4.网络接口层：数据链路层和物理层。用于数据传输，地址解析协议ARP也在这层作用（把ip地址转化为网卡地址16进制），在进行数据传输如果我们发送对象在一个局域网内，我们的ip转为为的物理地址（MAC地址）传输到交换机，交换机再在自己的接口寻找到接收的物理地址再进行数据传输，但是如果为跨网段或者在公网通信，我们才是靠ip地址。

## IP
1.IP包头存储了几十个字节地信息，有版本信息、长度信息、协议信息等，最重要的是源IP和目标IP，都是32位，也就是最多有42亿ip地址，分成4分，一份8位，用点分隔开。
2.上述2^32个ip可用地址其实没那么多一般用户用三个：1.0.0.0-126.255.255、128.0.0.0-191.255.255.255、192.0.0.0-223.225.225.225，分别为ABC三种，其中A中第一个表示不同网络，如果第一个数字不同但是要通信，这时就要路由器，进行不同网络通信，而如果是同一个网络我们用交换机就可以。B类中是前两个数表示一个网段，C类是前三个数表示一个网段，也就是在ABC中一个局域网最大主机数为2^24-2、2^16-2、2^8-2，其中-2是第一个和最后一个有别的用途网络地址广播地址。ABC都有私有ip和共有ip，私有免费A是10.0.0.0-10.255.255.255、B是172.16.255.255-172.31.255.255、C是192.168.0.0-192.168.255.255，这样的ip不可以和公有ip直接交互，因为这些ip太少，如果直接交互，公有ip无法识别到底是哪个ip请求。

## 子网的掩码
各类ABC子码掩码标注255.0.0.0、255.255.0.0、255.255.255.0，他不能喝ip地址分开查找，两个必须一起查找，子网掩码决定当前网段，判断交互是否位于同一网段，来以确定是否经过路由器来交互。

## 端口的作用
1.TCP协议爆头：源端口和目的端口最为重要，还存在序列号和确认号校验和等，UDP少很多主要就是源端口、目的端口16位。端口用来确定我们要用那种服务交互，一般FTP（文件的传输）20、21，SSH（安全的shell协议）22，DNS53，http80，SMTP25，POP3110。

## DNS
1.DNS其实类似于宏，我们的网站其实是通过ip访问，但是这太难记，所以就将ip转换为域名www.imooc.com。便于访问，一般我们在cmd进行交互，当我们输入一个域名，都是先进入我们C盘下的一个host文件中，寻找域名是否对应一个ip，如果有则进入该ip否则进入dns进行交互。可见用host维护性太难，而且不好查询，所以DNS的分布式和层次性提供了便利。
2.当我们直接访问网站一般先和DNS服务器发送消息查询该域名的ip，随后DNS返回ip然后我们再利用此ip访问。
3.域名的结构：根域名就是.，一级域名是由iso自我规定，是国家敏感地区组织专有的cn中国com商业组织，二级域名自己想iso申请购买的baidu，主机名就是www一类。这几个组成一个域名www.sina.com.cn，其中com、cn都是顶级域名。
4.dns查询：首先打本地域名服务器，询问www.baidu.com.cn存不存在缓存，如果不，本地域名服务器会向根dns服务器查询，根dns服务器会返回cn告诉他去询问cn服务器，然后问cn，他返回com.cn，去查询com.cn，再返回baidu.com.cn，再得到www来获取完整域名。

## 网关
1.网关用来进行不同网段的交互，如果两个主机在不同的网段，则通过网关或网关的网关找到对应的主机。
2.解析私人ip为公有。私人ip很少，需要用网关解析为唯一的公网ip才能交互。